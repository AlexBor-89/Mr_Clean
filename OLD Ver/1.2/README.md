# Mr. Clean

Разработчик: AlexBor  
Актуальную версию программы смотрите в разделе **История версий**  

**Mr. Clean** — это автоматизированная программа для очистки файлов и папок на компьютере.
Она позволяет удалять старые или ненужные файлы, высвобождая место на диске и поддерживая порядок в системе.
Программа работает как фоновое приложение с иконкой в системном трее и может быть легко настроена через конфигурационные файлы.

> ⚠️ **Важно:** ⚠️  
> Программа удаляет файлы безвозвратно! Убедитесь, что вы правильно настроили параметры перед запуском.

---

## Содержание
1. [Описание](#описание)  
2. [Формат файла config.cfg](#формат-файла-configcfg)  
3. [Формат файла values.ini](#формат-файла-valuesini)  
4. [Пример использования](#пример-использования)  
5. [Журналирование](#журналирование)  
6. [История версий](#история-версий)

---

### Описание
Программа предназначена для автоматической очистки файлов и папок по заданным правилам.  
Она поддерживает несколько методов удаления, маски файлов и ограничения времени выполнения операций.  

---

### Формат файла config.cfg
Файл `config.cfg` содержит настройки программы и определяет её поведение.  
Ниже приведено описание каждой секции и параметров:  


#### [SETTINGS]
Эта секция содержит основные настройки программы.

```
cycle-time-limit-sec
```
Максимальное время (в секундах), которое программа может тратить на обработку одного каталога или подкаталога.  
Если время превышено, обработка текущего каталога прекращается, и программа переходит к следующему.  
По умолчанию: `cycle-time-limit-sec = 180`


#### [LOG]
Эта секция содержит настройки логирования.

```
logging
```
Включение или отключение логирования. Установите значение `True`, чтобы включить логирование, или `False`, чтобы отключить.  
По умолчанию: `logging = True`

```
log-level
```
Уровень детализации логов. Доступные значения:  
- `DEBUG`: Все сообщения, включая отладочные.  
- `INFO`: Информационные сообщения и выше.  
- `WARNING`: Предупреждения и ошибки.  
- `ERROR`: Только ошибки.  
- `CRITICAL`: Критические ошибки.  

По умолчанию: `log-level = INFO`

```
log-days-limit
```
Максимальный возраст лог-файлов (в днях). Все логи старше указанного количества дней будут автоматически удалены.  
По умолчанию: `log-days-limit = 7`

---

### Формат файла values.ini
Файл `values.ini` содержит правила очистки для разных папок. Каждое правило находится в своей секции.

#### Структура секции:
```
[Name_1]
Path = "Путь к очищаемой папке"
Method = число от 0 до 4
Days = число больше 0
Mask = *.*

[Name_2]
Path = "Путь к очищаемой папке"
Method = число от 0 до 4
Days = число больше 0
Mask = *часть имени или имя файлов*.log
```

где:
- **Name** - это произвольное имя секции, которое идентифицирует очищаемую папку.
- **Path** - это путь к очищаемой папке, который может содержать переменные среды, например **%%TEMP%%**, **%%UserProfile%%** и т. д.
  - Путь должен быть заключён в кавычки, а переменные среды в двойные символы процента.
- **Method** - это метод удаления, который определяет, какие папки и файлы будут удалены. Возможные значения:
  - 0 - удаляет файлы и папки с вложенными файлами.
  - 1 - удаляет только папки с вложенными файлами.
  - 2 - удаляет только файлы по указанному пути.
  - 3 - удаляет только файлы в подпапках, но не сами подпапки.
  - 4 - удаляет все файлы в папке и в подпапках, с сохранением структуры папок.
- **Days** - это количество дней, за которые нужно оставить папки и файлы и не удалять их. Должно быть положительным целым числом.
- **Mask** - это маска для фильтрации файлов (например, `*.log`, `*.tmp`).
_Если параметр не указан, используется маска `*.*`. Маска применяется только для методов: 2, 3, 4_

---

### Пример использования
Допустим, вы хотите очистить папку загрузок пользователя от `.exe`, `.txt` и `.csv` файлов, старше 7 дней.  
Создайте файл `values.ini` со следующим содержанием:
```
[Downloads]
Path = "%%UserProfile%%\Downloads\"
Method = 2
Days = 7
Mask = *.exe, *.txt, *.csv
```

Затем вы можете просто запустить программу Mr. Clean.exe.  
Программа просканирует папку Загрузки и удалит все папки и файлы, дата последнего доступа к которым была более 7 дней назад.


### Журналирование
В программе Mr. Clean реализованы различные уровни Журналирования (логирования), которые помогают организовать запись логов с разной степенью детализации.

1. **DEBUG**:  
Самый подробный уровень.
  - Используется для отладки и трассировки.
  - Записывает все сообщения, включая детали выполнения программы.
2. **INFO**:  
Информационный уровень.
  - Используется для общей информации о ходе выполнения программы.
  - Записывает важные события, но не перегружает лог файл.
3. **WARNING**:  
Уровень предупреждения.
  - Используется для сообщений о потенциальных проблемах.
  - Записывает предупреждения, которые не являются критическими.
4. **ERROR**:  
Уровень ошибок.
  - Используется для сообщений об ошибках, которые не позволяют программе продолжить выполнение.
  - Записывает критические ошибки.
5. **CRITICAL**:  
Самый высокий уровень.
  - Используется для критических ошибок, которые могут привести к аварийному завершению программы.
  - Записывает только самые серьёзные события.



### ИСТОРИЯ ВЕРСИЙ

#### Версия программы: 1.2
Дата выпуска программы: 20.02.2025

- Исправлена проблема в методе 3, которая использовала глобальную настройку для очистки логов `log_days_limit`
- Добавлен новый метод очистки (4 - удаляет все файлы в папке и в подпапках, с сохранением структуры папок)
- Реализован функционал, который позволяет удалять файлы на основе маски расширений
- При нажатии на иконку в трее - открывается терминал с журналом действий
- Улучшен контроль времени выполнения (`cycle-time-limit-sec`)
  

#### Версия программы: 1.1
Дата выпуска программы: 14.02.2025

- Данные из файла `config.cfg` перенесены в файл `values.ini`
- В новом файле `config.cfg`:
  - Добавлена иконка в трей с кнопкой [Выход], которая принудительно завершает выполнение программы.
  - Добавлено логирование выполнения программы и настройка хранения файлов журналов (в днях).
  - Добавлен лимит на цикл очистки в секундах.
  

#### Версия программы: 1.0
Дата выпуска программы: 01.02.2024

- Первая версия программы